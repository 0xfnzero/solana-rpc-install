# Solana RPC èŠ‚ç‚¹å­˜å‚¨æŒ‚è½½ç­–ç•¥

## ðŸ“Š å½“å‰æŒ‚è½½é…ç½®ï¼ˆæœ€ä¼˜æ–¹æ¡ˆï¼‰

### ç£ç›˜åˆ†é…
```
nvme1n1 (1.7T NVMe)     â†’ /root/sol/accounts
nvme0n1p2 (1.7T NVMe)   â†’ / (ç³»ç»Ÿåˆ†åŒº)
                          â”œâ”€ /root/sol/ledger
                          â””â”€ /root/sol/snapshot
```

### æ€§èƒ½ä¸Žç©ºé—´åˆ†æž
| æŒ‚è½½ç‚¹ | ç£ç›˜ | å·²ç”¨ | å¯ç”¨ | ä½¿ç”¨çŽ‡ | I/O ç‰¹æ€§ |
|--------|------|------|------|--------|---------|
| `/root/sol/accounts` | nvme1n1 | 424GB | 1.3TB | 26% | ðŸ”´ æžé«˜é¢‘éšæœºè¯»å†™ |
| `/root/sol/ledger` | nvme0n1p2 | - | 1.3TB | 23% (æ€») | ðŸŸ¡ æŒç»­é¡ºåºå†™å…¥ |
| `/root/sol/snapshot` | nvme0n1p2 | - | 1.3TB | 23% (æ€») | ðŸŸ¢ å‘¨æœŸæ€§è¯»å†™ |

## ðŸŽ¯ è®¾è®¡åŽŸç†

### 1. Accounts ç›®å½•ï¼ˆæœ€å…³é”®ï¼‰
- **æ•°æ®ç±»åž‹**ï¼šè´¦æˆ·çŠ¶æ€æ•°æ®åº“ï¼ˆRocksDBï¼‰
- **I/O æ¨¡å¼**ï¼šæžé«˜é¢‘çŽ‡éšæœºè¯»å†™
- **ç©ºé—´éœ€æ±‚**ï¼š300-500GB+ï¼ˆæŒç»­å¢žé•¿ï¼‰
- **æ€§èƒ½å½±å“**ï¼šç›´æŽ¥å½±å“éªŒè¯å™¨åŒæ­¥é€Ÿåº¦å’Œ RPC å“åº”æ—¶é—´
- **æŒ‚è½½ç­–ç•¥**ï¼šâœ… ç‹¬äº« nvme1n1ï¼Œç¡®ä¿æœ€é«˜ IOPS

### 2. Ledger ç›®å½•
- **æ•°æ®ç±»åž‹**ï¼šåŒºå—é“¾åŽ†å²æ•°æ®
- **I/O æ¨¡å¼**ï¼šæŒç»­é¡ºåºå†™å…¥ï¼Œå¶å°”è¯»å–
- **ç©ºé—´éœ€æ±‚**ï¼šå¯æŽ§ï¼ˆé€šè¿‡ --limit-ledger-size é™åˆ¶ä¸º 50GBï¼‰
- **æ€§èƒ½å½±å“**ï¼šä¸­ç­‰ï¼Œä¸»è¦æ˜¯å†™å…¥å»¶è¿Ÿ
- **æŒ‚è½½ç­–ç•¥**ï¼šâœ… ç³»ç»Ÿç›˜è¶³å¤Ÿï¼Œä¸éœ€è¦ç‹¬ç«‹ç£ç›˜

### 3. Snapshot ç›®å½•
- **æ•°æ®ç±»åž‹**ï¼šå¿«ç…§å½’æ¡£æ–‡ä»¶
- **I/O æ¨¡å¼**ï¼šå‘¨æœŸæ€§å¤§æ–‡ä»¶è¯»å†™ï¼ˆä¸‹è½½/ç”Ÿæˆå¿«ç…§ï¼‰
- **ç©ºé—´éœ€æ±‚**ï¼š50-100GBï¼ˆ2-3 ä¸ªå¿«ç…§ï¼‰
- **æ€§èƒ½å½±å“**ï¼šè¾ƒä½Žï¼Œä¸æ˜¯å®žæ—¶æ•°æ®
- **æŒ‚è½½ç­–ç•¥**ï¼šâœ… ç³»ç»Ÿç›˜è¶³å¤Ÿï¼Œä¸Ž ledger å…±äº«

## ðŸ”§ è‡ªåŠ¨æŒ‚è½½ä¼˜å…ˆçº§

è„šæœ¬ `1-prepare.sh` è‡ªåŠ¨æ£€æµ‹å¯ç”¨ç£ç›˜å¹¶æŒ‰ä¼˜å…ˆçº§æŒ‚è½½ï¼š

```bash
# ä¼˜å…ˆçº§é¡ºåºï¼ˆä»Žé«˜åˆ°ä½Žï¼‰
1. ç¬¬ä¸€å—å¯ç”¨ç£ç›˜ â†’ /root/sol/accounts  (æœ€é«˜æ€§èƒ½éœ€æ±‚)
2. ç¬¬äºŒå—å¯ç”¨ç£ç›˜ â†’ /root/sol/ledger    (ä¸­ç­‰æ€§èƒ½éœ€æ±‚)
3. ç¬¬ä¸‰å—å¯ç”¨ç£ç›˜ â†’ /root/sol/snapshot  (ä½Žæ€§èƒ½éœ€æ±‚)
```

**å½“å‰æœåŠ¡å™¨**ï¼š
- âœ… nvme1n1 â†’ accountsï¼ˆå”¯ä¸€æ•°æ®ç›˜ï¼Œåˆ†é…ç»™æœ€éœ€è¦çš„ accountsï¼‰
- âºï¸ ledger â†’ ç³»ç»Ÿç›˜ï¼ˆæ— ç¬¬äºŒå—ç›˜ï¼Œä½¿ç”¨ç³»ç»Ÿç›˜ï¼‰
- âºï¸ snapshot â†’ ç³»ç»Ÿç›˜ï¼ˆæ— ç¬¬ä¸‰å—ç›˜ï¼Œä½¿ç”¨ç³»ç»Ÿç›˜ï¼‰

## ðŸ“ˆ æ‰©å±•å»ºè®®

### å¦‚æžœéœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½

**é€‰é¡¹ 1ï¼šæ·»åŠ ç¬¬äºŒå— NVMeï¼ˆæŽ¨èï¼‰**
```
nvme1n1   â†’ /root/sol/accounts
æ–° NVMe   â†’ /root/sol/ledger + /root/sol/snapshot
nvme0n1p2 â†’ / (ç³»ç»Ÿåˆ†åŒº)
```
**æ”¶ç›Š**ï¼šledger å†™å…¥ä¸å½±å“ç³»ç»Ÿç›˜ï¼Œç³»ç»Ÿæ›´ç¨³å®š

**é€‰é¡¹ 2ï¼šæ·»åŠ ä¸¤å— NVMeï¼ˆé«˜æ€§èƒ½ï¼‰**
```
nvme1n1   â†’ /root/sol/accounts
æ–° NVMe 1 â†’ /root/sol/ledger
æ–° NVMe 2 â†’ /root/sol/snapshot
nvme0n1p2 â†’ / (ç³»ç»Ÿåˆ†åŒº)
```
**æ”¶ç›Š**ï¼šå®Œå…¨éš”ç¦»ï¼Œä½†æ€§ä»·æ¯”ä½Žï¼ˆsnapshot ä¸éœ€è¦å¦‚æ­¤é«˜æ€§èƒ½ï¼‰

## âœ… éªŒè¯æŒ‚è½½çŠ¶æ€

### æ£€æŸ¥å½“å‰æŒ‚è½½
```bash
# æŸ¥çœ‹æŒ‚è½½ç‚¹
lsblk -o NAME,SIZE,TYPE,MOUNTPOINT

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h /root/sol/accounts /root/sol/ledger /root/sol/snapshot

# æŸ¥çœ‹å®žé™…æŒ‚è½½
mount | grep nvme
```

### é¢„æœŸè¾“å‡º
```
nvme1n1                 1.7T  disk  /root/sol/accounts
nvme0n1                 1.7T  disk
â”œâ”€nvme0n1p1             512M  part  /boot/efi
â””â”€nvme0n1p2             1.7T  part  /
```

## ðŸ” æ€§èƒ½ç›‘æŽ§

### I/O ç›‘æŽ§å‘½ä»¤
```bash
# å®žæ—¶ I/O ç›‘æŽ§
iostat -xm 2 nvme0n1 nvme1n1

# ç£ç›˜æ€§èƒ½æµ‹è¯•
fio --name=randread --ioengine=libaio --iodepth=16 --rw=randread \
    --bs=4k --direct=1 --size=1G --numjobs=1 --runtime=60 \
    --filename=/root/sol/accounts/test

# æ¸…ç†æµ‹è¯•æ–‡ä»¶
rm -f /root/sol/accounts/test
```

### é¢„æœŸæ€§èƒ½æŒ‡æ ‡
- **accounts (nvme1n1)**ï¼šIOPS > 100K, å»¶è¿Ÿ < 1ms
- **ç³»ç»Ÿç›˜ (nvme0n1p2)**ï¼šIOPS > 50K, å»¶è¿Ÿ < 2ms

## ðŸ“ æ•…éšœæŽ’æŸ¥

### é—®é¢˜ 1ï¼šaccounts æŒ‚è½½ä¸¢å¤±
```bash
# æ£€æŸ¥ fstab
cat /etc/fstab | grep accounts

# æ‰‹åŠ¨æŒ‚è½½
sudo mount /dev/nvme1n1 /root/sol/accounts

# éªŒè¯
df -h /root/sol/accounts
```

### é—®é¢˜ 2ï¼šç£ç›˜ç©ºé—´ä¸è¶³
```bash
# æ£€æŸ¥ ledger å¤§å°é™åˆ¶
systemctl status sol | grep limit-ledger-size

# æ¸…ç†æ—§å¿«ç…§
cd /root/sol/snapshot
ls -lht *.tar.bz2
rm -f old-snapshot*.tar.bz2
```

### é—®é¢˜ 3ï¼šæ€§èƒ½ä¸‹é™
```bash
# æ£€æŸ¥ç£ç›˜å¥åº·
sudo smartctl -a /dev/nvme1n1
sudo smartctl -a /dev/nvme0n1

# æ£€æŸ¥ I/O ç­‰å¾…
iostat -x 2
```

## ðŸŽ“ æœ€ä½³å®žè·µæ€»ç»“

âœ… **DO**ï¼š
- ä¿æŒ accounts ç‹¬ç«‹æŒ‚è½½åœ¨æœ€å¿«çš„ç£ç›˜ä¸Š
- ä½¿ç”¨ `--limit-ledger-size` æŽ§åˆ¶ ledger å¢žé•¿
- å®šæœŸæ¸…ç†æ—§å¿«ç…§ï¼ˆä¿ç•™ 2-3 ä¸ªæœ€æ–°ï¼‰
- ç›‘æŽ§ç£ç›˜ç©ºé—´å’Œ I/O æ€§èƒ½

âŒ **DON'T**ï¼š
- ä¸è¦å°† accounts å’Œå…¶ä»–æ•°æ®æ··åˆæŒ‚è½½
- ä¸è¦åœ¨ç³»ç»Ÿç›˜è€—å°½å‰æ‰æ¸…ç†æ•°æ®
- ä¸è¦ç¦ç”¨å¿«ç…§é™åˆ¶å‚æ•°
- ä¸è¦åœ¨ç”Ÿäº§çŽ¯å¢ƒéšæ„æ›´æ”¹æŒ‚è½½ç‚¹

## ðŸ“š ç›¸å…³é…ç½®æ–‡ä»¶

- **æŒ‚è½½è„šæœ¬**ï¼š`1-prepare.sh` (è‡ªåŠ¨æ£€æµ‹å’ŒæŒ‚è½½)
- **éªŒè¯å™¨é…ç½®**ï¼š`validator-*.sh` (å­˜å‚¨è·¯å¾„é…ç½®)
- **é‡å¯è„šæœ¬**ï¼š`restart_node.sh` (å¿«ç…§ä¸‹è½½è·¯å¾„)
- **ç›‘æŽ§è„šæœ¬**ï¼š`performance-monitor.sh` (ç£ç›˜æ€§èƒ½ç›‘æŽ§)

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0
**æœ€åŽæ›´æ–°**ï¼š2025-11-29
**ç»´æŠ¤è€…**ï¼šSolana RPC Team
